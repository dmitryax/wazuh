# Wazuh - Filebeat configuration file
filebeat.inputs:
  - type: log
    paths:
      - '/var/ossec/logs/alerts/alerts.json'

# Elasticsearch alerts template
setup.template.json.enabled: true
setup.template.json.path: "/etc/filebeat/wazuh-template.json"
setup.template.json.name: "wazuh"
setup.template.overwrite: true

processors:
  # Decode event as JSON
  - decode_json_fields:
      fields: ['message']
      process_array: true
      max_depth: 200
      target: ''
      overwrite_keys: true
  # Drop Filebeat added fields
  - drop_fields:
      fields: ['message', 'ecs', 'beat', 'input_type', 'tags', 'count', '@version', 'log', 'offset', 'type', 'host']

# Elasticsearch output
output.elasticsearch.hosts: ['http://YOUR_ELASTIC_SERVER_IP:9200']
output.elasticsearch.pipeline: wazuh
output.elasticsearch.indices:
  - index: 'wazuh-alerts-3.x-%{+yyyy.MM.dd}'

# Optional. Logstash output
#output.logstash.hosts: ["YOUR_LOGSTASH_SERVER_IP:5000"]
